rule COLDDRAW_PoC {
    meta:
        last_updated = "2023-2-2"
        author = "Grimmie"
        description = "YARA Rule for COLDDRAW PoC as presented at HackMiami by FortyNorthSec"
    
    strings:
        $namespace1 = "System.IO" nocase ascii
        $namespace2 = "Org.BouncyCastle" nocase ascii
        $namespace3 = "System.Runtime" nocase ascii
        $namespace4 = "System.Reflection" nocase ascii
        $namespace5 = "System.Diagnostics" nocase ascii
        $namespace6 = "System.Text" nocase ascii

        $misc1 = "ToBase64String" nocase ascii
        $misc2 = "set_SecurityProtocol" nocase ascii
        $misc3 = "PemReader" nocase ascii
        $misc4 = "HttpRequestHeader" nocase ascii
        $misc5 = "RSACryptoServiceProvider" nocase ascii
        $misc6 = "AsymmetricKeyParameter" nocase ascii
        $misc7 = "AsymmetricCipherKeyPair" nocase ascii
        $misc8 = "RSAParameters" nocase ascii
        $misc9 = ".cuba" nocase ascii



    condition:
        all of $namespace* and
        all of $misc*
        
}
